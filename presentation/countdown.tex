\begin{frame}
\frametitle{Step 2: Inverting the hierarchies via countdown\\ Roadmap}
\begin{enumerate}\itemsep2em
	\item \textcolor<2>{red}{\emph{What is inverse?} Upper inverse and increasing functions.}
	\item \emph{Can Repeater preserve Invertibility?} Repeatable functions.
	\item \emph{Computing inverse with inverse:} Contractions and \textbf{Countdown}.
	\item Invert each level in hyperoperations/Ackermann hierarchies.
\end{enumerate}
\end{frame}


\subsection{Upper inverses and increasing functions}

\begin{frame}
\frametitle{Upper inverses of increasing, unbounded functions}
The \href{https://github.com/inv-ack/inv-ack/blob/7270e64a2600b771f2b1b1b151f7d13fb2ae6c97/inverse.v\#L28-L45}{
	\emph{upper inverse}} of $F$, written $F^{-1}$,
% {\color{red} $F^{-1}$, $F^{-1}_{\mathit{\shortuparrow}}$, $F^{-1}_{\upharpoonleft}$}
is $\lambda n. \min\{m : F(m)\ge n\}$.

Note that $F^{-1}$ is a total function when $F$ is unbounded.

\bigskip

\textbf{Analogue of inverse of injections:} The \emph{upper inverse} makes sense for \emph{strictly increasing} (hereafter referred to simply as \emph{increasing}). Increasingness parallels injectivity.

\smallskip
Note: Increasing functions are trivially unbounded.

\bigskip

\textbf{Logical equivalence (more useful):}
\href{https://github.com/inv-ack/inv-ack/blob/7270e64a2600b771f2b1b1b151f7d13fb2ae6c97/inverse.v\#L65-L77}{\coq} If $F:\mathbb{N}\to \mathbb{N}$ is increasing, then $f$ is the upper inverse of $F$ if and only if $\ \forall n, m.~ f(n)\le m \iff n \le F(m)$.

\end{frame}

\subsection*{}
\begin{frame}
\frametitle{Step 2: Inverting the hierarchies via countdown\\ Roadmap}
\begin{enumerate}\itemsep2em
	\item \textcolor<1-2>{gray}{\emph{What is inverse?} Upper inverse and increasing functions.}
	\item \textcolor<2>{red}{\emph{Can Repeater preserve Invertibility?} Repeatable functions.}
	\item \emph{Computing inverse with inverse:} Contractions and \textbf{Countdown}.
	\item Invert each level in hyperoperations/Ackermann hierarchies.
\end{enumerate}
\end{frame}


\subsection{Expansions and Repeatable functions}

\begin{frame}
\frametitle{Expansions and Repeatable functions 1}

\textbf{Observation:} Every function in the hyperoperations (when $a\ge 2$) and the Ackermann hierarchy is increasing. How do they become that?

\smallskip

\textbf{Generalization:} What properties ensure increasing-ness is preserved by Repeater?

\bigskip

\textbf{Repeatability:} a property that encompasses increasing-ness that is preserved through Repeater.
\begin{equation*}
Repeatable = Increasing + Strict \ Expanding
\end{equation*}

\textbf{Expansions:} A function $F:\mathbb{N}\to\mathbb{N}$ is an
\href{https://github.com/inv-ack/inv-ack/blob/7270e64a2600b771f2b1b1b151f7d13fb2ae6c97/increasing_expanding.v\#L80-L82}{\emph{expansion}} if $\forall n.~ F(n)\ge n$. Further, for $a\in \mathbb{N}$, an expansion $F$ is
\href{https://github.com/inv-ack/inv-ack/blob/7270e64a2600b771f2b1b1b151f7d13fb2ae6c97/increasing_expanding.v\#L84-L86}{\emph{strict from}} $a$ if ~$\forall n \ge a.~ F(n) > n$.
\end{frame}


\begin{frame}
\frametitle{Expansion and Repeatable functions 2}
\label{frame:repeatable2}
\textbf{Repeatability:} An increasing function $f$ is \emph{repeatable} from $a$ if $f$ is also an expansion that is strict from $a$.

\smallskip

The set of functions repeatable from $a$ is denoted by $\repeatable_a$.

\smallskip

\textbf{Observation.} If $a\le b$, $\repeatable_a\subseteq \repeatable_b$.

\bigskip

\textbf{Repeatability Preservation Theorem.} $\forall a\ge 1$, if $f \in \repeatable_a$, then $\rf{f}{a} \in \repeatable_0$, meaning $\rf{f}{a}$ is repeatable from any $b$.

\bigskip

Every level in the hyperoperations (when $a\ge 2$) and Ackermann hierarchies are repeatable from their respective initial values.

$\implies$ All invertible.

\end{frame}


\subsection*{}
\begin{frame}
\frametitle{Step 2: Inverting the hierarchies via countdown\\ Roadmap}
\begin{enumerate}\itemsep2em
	\item \textcolor<1-2>{gray}{\emph{What is inverse?} Upper inverse and increasing functions.}
	\item \textcolor<1-2>{gray}{\emph{Can Repeater preserve Invertibility?} Repeatable functions.}
	\item \textcolor<2>{red}{\emph{Computing inverse with inverse:} Contractions and \textbf{Countdown}.}
	\item Invert each level in hyperoperations/Ackermann hierarchies.
\end{enumerate}
\end{frame}


\subsection{Contractions and the countdown operation}


\begin{frame}
\frametitle{Definitions}
\textbf{Contractions.} A function $f : \mathbb{N} \to \mathbb{N}$ is a
\href{https://github.com/inv-ack/inv-ack/blob/7270e64a2600b771f2b1b1b151f7d13fb2ae6c97/countdown.v\#L40-L42}{\emph{contraction}} if $\forall n.~ f(n) \le n$.

Given an $a \ge 1$, a contraction $f$ is
\href{https://github.com/inv-ack/inv-ack/blob/7270e64a2600b771f2b1b1b151f7d13fb2ae6c97/countdown.v\#L44-L46}{\emph{strict above}} $a$ if $\forall n > a.~n > f(n)$.

\bigskip

\textbf{Notations.} Set of contractions: $\contract$. Set of contractions strict above $a$: $\contract_a$.

\bigskip

\textbf{Observations.} Analogously to
\nameref{frame:repeatable2}, $\forall s\le t.~ \contract_s \subseteq \contract_t$.

\bigskip

\textbf{Countdown.} Let $f\in \contract_a$. The \textit{countdown to} $a$ of $f$, written
$\cdt{f}{a}(n)$, is the smallest number of times $f$ needs to be applied to
$n$ for the answer to equal or go below $a$. \emph{i.e.},
\begin{equation*}
\cdt{f}{a}(n) \triangleq \min\{m: f^{(m)}(n)\le a \}.
\end{equation*}
\end{frame}


\begin{frame}
\frametitle{The importance of Countdown}
\textbf{Theorem.} $\forall a$, $\forall F\in \repeatable_a$, define $f\triangleq F^{-1}$. 
\\ Then $f\in \contract_a$ and $\cdt{f}{a}~ = \left(\rf{F}{a}\ \right)^{-1}$.

\bigskip

\textbf{Proof.}
\emph{Step 1.} $f\in \contract_a$:

Since $F$ is an expansion, $n \le F(n)\implies f(n)\le n$.
Take $n> a$, Since $F$ is strict from $a$, $n-1 < F(n-1) \implies n\ge F(n-1)$ $\implies f(n)\le n - 1 \implies f(n) < n$.

\bigskip

\emph{Step 2.} $\cdt{f}{a}~ = \left(\rf{F}{a}\ \right)^{-1}$. We have
\begin{equation*} \label{eq: rf-upp-inv}
\begin{aligned}
& \cdt{f}{a}(n)\le m \iff f^{(m)}(n)\le a \iff f^{(m-1)}(n)\le F(a) \iff \ldots \\
&  \iff f(n)\le F^{(m-1)}(a) \iff n\le F^{(m)}(a) \iff n\le \rf{F}{a}(m)
\end{aligned}
\vspace{-0.5em}
\end{equation*}
Thus the proof is complete.

\end{frame}


\begin{frame}[fragile]
\frametitle{A Countdown computation in Coq type \texttt{nat} 1}
\textbf{Idea.} To compute $\cdt{f}{a}(n)$, starting from $n$, repeatedly apply $f$ to get the chain $\{n, f(n), f^{(2)}(n), \ldots \}$. Stops when $f^{(k)}(n)\le a$. Returns $k$.

\bigskip

\textbf{Primary issue.} Coq needs a known terminating point, i.e. an explicit decreasing argument. How to know when to terminate beforehand?

\smallskip

\textbf{Secondary issue.} It's hard to define a Coq definition of Countdown for contractions only. Defining a computation for \emph{all functions} that actually computes Countdown on contractions is easier.

\bigskip

\textbf{The worker function.} A worker function takes $f, a, n$ and a budget $b$ and compute the chain $\{n, f(n), \ldots, f^{(b)}(n)\}$. It stops before reaching $f^{(b)}(n)$ upon encountering $k$ such that $f^{(k)}(n)\le a$.

\bigskip

\textbf{Primary issue.} How to determine a sufficient budget?
\end{frame}


\begin{frame}[fragile]
\frametitle{A Countdown computation in Coq type \texttt{nat} 2}

\textbf{The worker function.} For any $a\in \mathbb{N}$ and $f: \mathbb{N}\to \mathbb{N}$, the
\emph{countdown worker}
to $a$ of $f$ is a function $\cdw{f}{a}\ : \mathbb{N}^2\to \mathbb{N}$ such that:
\begin{equation*}
\cdw{f}{a}(n, b) = \begin{cases}
0 & \text{if } b = 0 \vee n\le a \\ 1 +\cdw{f}{a}(f(n), b-1) & \text{if } b \ge 1 \wedge n > a
\end{cases}
\end{equation*}

% Linked by A
\begin{lstlisting}
`\href{https://github.com/inv-ack/inv-ack/blob/7270e64a2600b771f2b1b1b151f7d13fb2ae6c97/countdown.v#L103-L108}{Fixpoint cdn\_wkr}` (a : nat) (f : nat -> nat) (n b : nat) : nat :=
  match b with 0 => 0 | S b' =>
    if (n <=? a) then 0 else S (cdn_wkr f a (f n) k')
end.
\end{lstlisting}

\textbf{The Countdown computation.} We choose a budget equals to $n$, which is sufficient.
Redefine $\cdt{f}{a}(n)
\triangleq \cdw{f}{a}(n, n)$.
% Linked by A
\begin{lstlisting}
`\href{https://github.com/inv-ack/inv-ack/blob/7270e64a2600b771f2b1b1b151f7d13fb2ae6c97/countdown.v#L112}{Definition countdown\_to}` a f n := cdn_wkr a f n n.
\end{lstlisting}
\end{frame}




\subsection*{}
\begin{frame}
\frametitle{Step 2: Inverting the hierarchies via countdown\\ Roadmap}
\begin{enumerate}\itemsep2em
	\item \textcolor<1-2>{gray}{\emph{What is inverse?} Upper inverse and increasing functions.}
	\item \textcolor<1-2>{gray}{\emph{Can Repeater preserve Invertibility?} Repeatable functions.}
	\item \textcolor<1-2>{gray}{\emph{Computing inverse with inverse:} Contractions and \textbf{Countdown}.}
	\item \textcolor<2>{red}{Invert each level in hyperoperations/Ackermann hierarchies.}
\end{enumerate}
\end{frame}


\subsection{Inverting the hyperoperations/Ackermann hierarchies}
\input{inv_hyperop.tex}
