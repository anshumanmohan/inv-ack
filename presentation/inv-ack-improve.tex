\subsection{Implementations}
\begin{frame}
\frametitle{Implementation Idea}
\textbf{Redefinition.}
$
\alpha(n) = \min\{k: n\le A(k, k) \} \triangleq \min\{k: \alpha_k(n)\le k \}
$

\bigskip

\pause 
\textbf{The worker function.} $\begin{cases}
\text{Budget } b: & \hspace{-1em}\text{Maximum } b \text{ steps. } \\
\text{Step } i: & \hspace{-1em}\text{Compute } \alpha_i(n). \\
\text{Stops when: } & \hspace{-1em}\text{budget reaches } 0 \text{ or } \alpha_i(n) \le i.
\end{cases}$

%\textbf{The worker function.}
%\bigskip
%\begin{itemize}
%	\item Budget $b$: Maximum $b$ steps.
%	\item Step $i$: Computes $\alpha_i(n)$.
%	\item Stops when budget reaches $0$ or $\alpha_i(n) \le i$.
%\end{itemize}

\bigskip

\pause 
\textbf{Advantage.} $\alpha_{i+1}(n) = \cdt{\big(\alpha_i\big)}{1}\big(\alpha_i(n)\big)$\\
\smallskip
$\implies$ next step is computable from the previous.
\end{frame}


\begin{frame}[fragile]
\frametitle{The Worker Function}

\uncover<1->{$\displaystyle 	\alpha^{\W}(f, n, k, b) = \begin{cases}
k & \text{if } b = 0 \vee n\le k \\ \alpha^{\W}(\cdt{f}{1}\circ f , \cdt{f}{1}(n), k+1, b-1) & \text{if } b \ge 1 \wedge n \ge k+1
\end{cases}$}

\bigskip

\begin{overlayarea}{\linewidth}{3cm}
\begin{onlyenv}<2->
	\begin{lstlisting}
`\href{https://github.com/inv-ack/inv-ack/blob/7270e64a2600b771f2b1b1b151f7d13fb2ae6c97/inv_ack.v#L155-L161} {Fixpoint inv\_ack\_wkr}` (f : nat -> nat) (n k b : nat) : nat :=
match b with 0 => 0 | S b' =>
  if (n <=? k) then k else let g := (countdown_to f 1) in
                      inv_ack_wkr (compose g f) (g n) (S k) b
end.
\end{lstlisting}
\end{onlyenv}
\end{overlayarea}

\end{frame}



\begin{frame}
\frametitle{The Worker Function}

\textbf{Observation.}
\begin{equation*}
\begin{array}{lllllll}
Initial \ Arguments & & \big(\alpha_i, & \alpha_i(n), & i, & b - i \big) \\[5pt]
\pause
b - i > 0, \ \alpha_i(n) > i & \pause \to & \big(\cdt{\alpha_i}{1}\circ \alpha_i, & \cdt{\alpha_i}{1}(\alpha_i(n)), & i + 1, & b - i - 1\big) \\[5pt]
\pause
{\color{blue} b > i}, \ \hspace{15pt} \alpha_i(n) > i & \to  & \big({\color{blue} \alpha_{i+1}}, & {\color{blue} \alpha_{i+1}(n)}, & i + 1, & {\color{blue} b - (i + 1)}\big) \\
\end{array}
\end{equation*}

\pause
\textbf{Execution.}
\begin{equation*}
\begin{array}{l|lllllll}
Step & Initial \ Arguments &  &  \big(\alpha_0, & \alpha_0(n), & 0, & b - 0 \big) \\[3pt]
\pause
0 & b > 0, \ \alpha_0(n) > 0 & \pause \to & \big(\alpha_1, & \alpha_1(n), & 1, & b - 1\big) \\[3pt]
\pause
1 & b > 1, \ \alpha_1(n) > 1 & \pause \to  & \big(\alpha_2, & \alpha_2(n), & 2, & b - 2\big) \\[3pt]
\pause
\cdots & \cdots & \cdots & \multicolumn{4}{l}{\cdots} \\
%b > k-1, \ \alpha_{k-1}(n) > k - 1 & \to  & \big(\alpha_k, & \alpha_k(n), & k, & b - k\big) & k-1 \\
\pause
k & b > k, \ {\color{red} \alpha_{k}(n) \le k} & \pause \to  & \multicolumn{4}{l}{\impinline{$k = \alpha(n)$}}
\end{array}
\end{equation*}
\end{frame}



\begin{frame}
\frametitle{The Inverse Ackermann Function}

Any budget $b \ge \alpha(n)$ suffices, so we can choose $b := n$.

\bigskip

\pause
\textbf{First version:} $\bigO(n^2)$.
\pause
\begin{equation*}
\alpha(n) = \alpha^{\mathcal{W}}\big(\alpha_0, \alpha_0(n), 0, n\big)
= \alpha^{\mathcal{W}}\big(\lambda n(n - 1), n - 1, 0, n\big)
\end{equation*}

\smallskip

\pause
\textbf{Simple improvement:} $\bigO(n)$.
\pause
\begin{equation*}
\begin{aligned}
\alpha(n) & = \begin{cases}
\alpha^{\mathcal{W}}\big(\alpha_{{\color{red} 1}}, \alpha_{{\color{red} 1}}(n), {{\color{red} 1}}, n - {{\color{red} 1}}\big) & \hspace{3em}\text{ when } n > \Ack(0) \\
0 & \hspace{3em}\text{ when } n \le \Ack(0)
\end{cases} \\[5pt]
\pause & = \begin{cases}
\alpha^{\mathcal{W}}\big(\lambda n(n - 2), n - 2, 1, n - 1\big) & \text{ when } n > 1 \\
0 & \text{ when } n \le 1
\end{cases}
\end{aligned}
\end{equation*}

\end{frame}


\subsection{Time Complexity: $\bigO(n)$}

\begin{frame}
\frametitle{Runtime of Countdown}

\textbf{Sum by component in each recursive step.}
\begin{equation*}
\begin{array}{l|llllll}
Step & \multicolumn{2}{l}{Initial \ Arguments} &  & \big(f^{(0)}(n), & n - 0 \big) &  \\[3pt]
\pause 0    & n - 0 > 0,     & f^{(0)}(n) > a & \to & \big(f^{(1)}(n), & n - 1\big) & + 1 \\[3pt]
\pause 1    & n - 1 > 0, & f^{(1)}(n) > a & \to & \big(f^{(2)}(n), & n - 2\big) & + 2 \\[3pt]
\pause \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \\
k-1  & n - (k-1) > 0, & f^{(k-1)}(n) > a & \to & \big(f^{(k)}(n), & n - k\big) & + k \\[3pt]
\pause k & n - k \mathrel{?} 0, & {\color{red} f^{(k)}(n) \le a}  &\to & \multicolumn{2}{l}{0} &  \\[3pt] \hline
SUM & \pause \Theta(k) & \pause \Theta((a+1)k) \pause & &  \multicolumn{2}{c}{\sum_{i=0}^{k-1}\runtime_f\big(f^{i}(n)\big)} & \pause \Theta(k)
\end{array}
\end{equation*}

%TODO: Increase vertical space after \hline

\pause
Substitute $k = \cdt{f}{a}(n)$:
%\begin{equation*}
\imppar{$\displaystyle
\runtime_{\cdt{f}{a}}(n) = \sum_{i=0}^{\cdt{f}{a}(n)-1}\runtime_f\big(f^{i}(n)\big)
+ \Theta\left((a+1)\cdt{f}{a}(n)\right).
$}
%\end{equation*}
\end{frame}



\begin{frame}
\frametitle{Runtime of Each $\alpha_i$ - Asymptotic Bounds}

$\displaystyle
\alpha_{i+1} = \cdt{\big(\alpha_i\big)}{1}\circ \alpha_i
\quad \implies \quad \runtime_{\alpha_{i+1}}(n) = \runtime_{\alpha_i}(n) + \runtime_{\cdt{\alpha_i}{1}}\big(\alpha_i(n)\big)
$

\smallskip
\pause 
\imppar{
$\displaystyle
\runtime_{\alpha_{i+1}}(n) = \runtime_{\alpha_i}(n) + 
\sum_{i=0}^{\cdt{\alpha_i}{1}(\alpha_i(n)) - 1} \runtime_{\alpha_i}\left(\alpha_i^{(i+1)}(n)\right) + \Theta\left(\cdt{\alpha_i}{1}(\alpha_i(n)) \right)
$
}

\bigskip

\pause 
Substitute $\cdt{\alpha_i}{1}(\alpha_i(n))$ for $\alpha_{i+1}(n)$:
\bigskip

$ \displaystyle 
\runtime_{\alpha_{i+1}}(n)
  = \runtime_{\alpha_i}(n) + 
  \sum_{i=0}^{\alpha_{i+1}(n) - 1} \runtime_{\alpha_i}\left(\alpha_i^{(i+1)}(n)\right) + \Theta\left(\alpha_{i+1}(n) \right)
$

\pause 
\smallskip
\imppar{
$\displaystyle 
\runtime_{\alpha_{i+1}}(n)
	= \sum_{i=0}^{\alpha_{i+1}(n)} \runtime_{\alpha_i}\left(\alpha_i^{(i)}(n)\right) + \Theta\left(\alpha_{i+1}(n) \right)
$
}

\end{frame}


\begin{frame}
\frametitle{Runtime of Each $\alpha_i$ - Precise Bounds}

Countdown running time:
\begin{equation*}
\textstyle \runtime_{\cdt{f}{a}}(n) =
\sum_{i=0}^{\cdt{f}{a}(n) - 1} \runtime_f\left(f^{(i)}(n)\right)
+ (a + 2)\cdt{f}{a}(n) + f^{\left(\cdt{f}{a}(n)\right)}(n) + 1
\end{equation*}

\smallskip

\pause 
$\alpha_2$ and $\alpha_3$ running time: $\runtime_{\alpha_2}(n) \le 2n - 2$ and $\runtime_{\alpha_3}(n) \le 4n + 4$.

\bigskip 

\pause 
$\alpha_i$ running time:
\begin{equation*}
\textstyle \runtime_{\alpha_{i+1}}(n) \le \sum_{k=0}^{\alpha_{i+1}(n)}\runtime_{\alpha_i}\left( \alpha_i^{(k)}(n)\right) + 3\alpha_{i+1}(n) + 3
\end{equation*}

\smallskip

\pause 
\imppar{
\begin{minipage}{\linewidth}
	\textbf{Theorem.} $\forall i.~\runtime_{\alpha_i}(n) \le 4n + \left(19\cdot 2^{i-3} - 2i - 13\right)\log_2n + 2i = \bigO(n)$, when using $\alpha_1 \triangleq \lambda n. (n-2)$.
\end{minipage}}

\end{frame}



\begin{frame}
\frametitle{Runtime of Inverse Ackermann}

\begin{equation*}
\begin{array}{l|llllllll}
Step & \multicolumn{2}{l}{Initial \ Arguments} &  &  \big(\alpha_1, & \alpha_1(n), & 1, & b - 1 \big) \\[3pt]
\pause 1 & b - 1 > 0, & \alpha_1(n) > 1 & \to & \big(\alpha_2, & \alpha_2(n), & 2, & b - 2\big) \\[3pt]
2 & b - 2 > 0, & \alpha_2(n) > 2 & \to  & \big(\alpha_3, & \alpha_3(n), & 3, & b - 3\big) \\
\cdots & \cdots &\cdots & \cdots & \cdots & \cdots & \cdots \\
%b > k-1, \ \alpha_{k-1}(n) > k - 1 & \to  & \big(\alpha_k, & \alpha_k(n), & k, & b - k\big) & k-1 \\
k & b - k > 0, & {\color{red} \alpha_{k}(n) \le k} & \to  & \multicolumn{4}{l}{k = \alpha(n)} \\[3pt] \hline
\pause SUM & \pause \Theta(k) & \pause \Theta\big(\sum_{i=1}^{k}i\big) \pause & & \multicolumn{4}{l}{\sum_{i=1}^{k-1} \runtime_{\cdt{\alpha_i}{1}} (\alpha_i(n))} \\[3pt]
\pause = & \Theta(k) & \Theta(k^2) & & \multicolumn{4}{l}{\sum_{i=1}^{k-1} \big(\runtime_{\alpha_{i+1}}(n) - \runtime_{\alpha_i}(n) \big)}
\end{array}
\end{equation*}

\smallskip

\pause
Therefore, 
\imppar{$\displaystyle
\begin{aligned}
\runtime_{\alpha}(n)
& = \runtime_{\alpha_{\alpha(n)}}(n) - \runtime_{\alpha_1}(n) + \Theta\left(\alpha(n)^2\right) + \runtime_{\alpha_1}(n) \\
& = \bigO \left(n + 2^{\alpha(n)}\log_2n + \alpha(n)^2 \right) = \bigO (n)
\end{aligned}
$}

\end{frame}